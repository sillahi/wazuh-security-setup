<!-- Wazuh Manager Configuration File -->
<ossec_config>
  <!-- Global Settings -->
  <global>
    <jsonout_output>yes</jsonout_output>
    <alerts_log>yes</alerts_log>
    <logall>no</logall>
    <memory_size>8G</memory_size>
  </global>

  <!-- Cluster Configuration -->
  <cluster>
    <name>wazuh-cluster</name>
    <node_name>node-1</node_name>
    <node_type>master</node_type>
    <key>c98b62a9b6169ac5f67dae155ae3a490</key>
    <port>1516</port>
    <bind_addr>0.0.0.0</bind_addr>
    <nodes>
      <node>192.168.1.100</node>
    </nodes>
    <hidden>no</hidden>
    <disabled>no</disabled>
  </cluster>

  <!-- Email Alerts -->
  <email_alerts>
    <email_to>admin@company.com</email_to>
    <level>12</level>
    <rule_id>100001</rule_id>
    <do_not_delay></do_not_delay>
  </email_alerts>

  <!-- Integration with External Tools -->
  <integration>
    <name>virustotal</name>
    <api_url>https://www.virustotal.com/vtapi/v2/</api_url>
    <api_username>your_virustotal_api_key</api_username>
    <alert_format>json</alert_format>
  </integration>

  <!-- Active Response -->
  <active-response>
    <command>firewall-drop</command>
    <location>local</location>
    <level>6</level>
    <timeout>600</timeout>
  </active-response>

  <active-response>
    <command>disable-account</command>
    <location>local</location>
    <level>6</level>
    <timeout>600</timeout>
  </active-response>

  <!-- File Integrity Monitoring -->
  <syscheck>
    <frequency>43200</frequency>
    <scan_on_start>yes</scan_on_start>
    <alert_new_files>yes</alert_new_files>
    <auto_ignore>no</auto_ignore>
    <scan_timeout>0</scan_timeout>
    <scan_day>sunday</scan_day>
    <scan_time>02:00</scan_time>
    
    <!-- Critical System Files -->
    <directories check_all="yes">/etc,/usr/bin,/usr/sbin</directories>
    <directories check_all="yes">/bin,/sbin,/boot</directories>
    
    <!-- Web Application Files -->
    <directories check_all="yes">/var/www/html</directories>
    <directories check_all="yes">/opt/webapp</directories>
    
    <!-- Database Files -->
    <directories check_all="yes">/var/lib/mysql</directories>
    <directories check_all="yes">/var/lib/postgresql</directories>
    
    <!-- Configuration Files -->
    <directories check_all="yes">/etc/ssh,/etc/pam.d</directories>
    <directories check_all="yes">/etc/sudoers.d,/etc/cron.d</directories>
    
    <!-- Exclude Patterns -->
    <ignore>/etc/mtab</ignore>
    <ignore>/etc/hosts.deny</ignore>
    <ignore>/etc/mail/statistics</ignore>
    <ignore>/etc/random-seed</ignore>
    <ignore>/etc/random.seed</ignore>
    <ignore>/etc/adjtime</ignore>
    <ignore>/etc/httpd/logs</ignore>
  </syscheck>

  <!-- Rootcheck -->
  <rootcheck>
    <frequency>43200</frequency>
    <scan_on_start>yes</scan_on_start>
    <unixaudit>/var/ossec/etc/shared/unixaudit</unixaudit>
    <windowsaudit>/var/ossec/etc/shared/windowsaudit</windowsaudit>
    <scanall>yes</scanall>
  </rootcheck>

  <!-- Log Analysis -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/messages</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/secure</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/maillog</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/cron</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/boot.log</location>
  </localfile>

  <!-- Apache Logs -->
  <localfile>
    <log_format>apache</log_format>
    <location>/var/log/httpd/access_log</location>
  </localfile>

  <localfile>
    <log_format>apache</log_format>
    <location>/var/log/httpd/error_log</location>
  </localfile>

  <!-- SSH Logs -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/auth.log</location>
  </localfile>

  <!-- Database Logs -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/mysql/error.log</location>
  </localfile>

  <!-- Custom Application Logs -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/application.log</location>
  </localfile>

  <!-- Windows Event Logs -->
  <localfile>
    <log_format>eventlog</log_format>
    <location>Application</location>
  </localfile>

  <localfile>
    <log_format>eventlog</log_format>
    <location>Security</location>
  </localfile>

  <localfile>
    <log_format>eventlog</log_format>
    <location>System</location>
  </localfile>

  <!-- Client Buffer Configuration -->
  <client_buffer>
    <disabled>no</disabled>
    <queue_size>50000</queue_size>
    <events_per_second>500</events_per_second>
  </client_buffer>

  <!-- Vulnerability Assessment -->
  <vulnerability-detector>
    <enabled>yes</enabled>
    <interval>5m</interval>
    <min_full_scan_interval>6h</min_full_scan_interval>
    <run_on_start>yes</run_on_start>
  </vulnerability-detector>

  <!-- Policy Monitoring -->
  <policy_monitoring>
    <enabled>yes</enabled>
    <frequency>12h</frequency>
    <scan_on_start>yes</scan_on_start>
  </policy_monitoring>

  <!-- SCA (Security Configuration Assessment) -->
  <sca>
    <enabled>yes</enabled>
    <scan_on_start>yes</scan_on_start>
    <interval>12h</interval>
    <skip_nfs>yes</skip_nfs>
  </sca>

  <!-- Database Output -->
  <database_output>
    <hostname>localhost</hostname>
    <username>wazuh</username>
    <password>wazuh_password</password>
    <database>wazuh</database>
    <type>mysql</type>
  </database_output>

  <!-- Slack Integration -->
  <integration>
    <name>slack</name>
    <hook_url>https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK</hook_url>
    <api_url>https://slack.com/api/</api_url>
    <alert_format>json</alert_format>
  </integration>

  <!-- Jira Integration -->
  <integration>
    <name>jira</name>
    <api_url>https://your-domain.atlassian.net</api_url>
    <api_username>your_jira_username</api_username>
    <api_password>your_jira_password</api_password>
    <alert_format>json</alert_format>
  </integration>
</ossec_config> 